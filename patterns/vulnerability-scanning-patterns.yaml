id: vulnerability-scanning-patterns
category: patterns
priority: 10
updated: 2026-02-02

title: Vulnerability Scanning & Supply Chain Security
description: |
  OWASP Top 10:2025 risk categories, supply chain security (A03), attack
  surface mapping, risk prioritization with CVSS/EPSS, fail-secure
  error handling, and high-risk code pattern detection.

rules:
  - action: ALWAYS
    rule: "Apply Zero Trust principle - never trust, always verify at every layer boundary"
  - action: ALWAYS
    rule: "Design fail-secure - on error, deny access rather than allowing it (fail-closed, not fail-open)"
  - action: ALWAYS
    rule: "Verify dependency integrity with checksums and lock files - pin versions and audit updates before merging"
  - action: ALWAYS
    rule: "Scan for high-risk code patterns: string concatenation in queries, eval/exec, unsafe deserialization, user input in file paths"
  - action: ALWAYS
    rule: "Prioritize vulnerabilities by exploitability (EPSS) and asset value, not just CVSS severity score alone"
  - action: ALWAYS
    rule: "Map attack surface before scanning: entry points, data flows, trust boundaries, and sensitive assets"
  - action: ALWAYS
    rule: "Run continuous scanning in CI/CD - not just once before deployment"
  - action: NEVER
    rule: "Trust third-party dependencies blindly - verify integrity, audit new packages, use private registries for critical deps"
  - action: NEVER
    rule: "Implement fail-open error handling on security operations - auth errors must deny access, not grant it"
  - action: NEVER
    rule: "Alert on every CVE without context - prioritize by EPSS exploitability score and asset criticality"
  - action: PREFER
    rule: "Use defense in depth - multiple security layers so no single point of failure compromises the system"
  - action: PREFER
    rule: "Address root causes, not symptoms - if SQL injection is found, fix the query pattern not just the one instance"

anti_patterns:
  - "Fail-open auth error handlers that grant access when authentication service is unavailable"
  - "Scanning once before release then never again - new vulnerabilities are discovered daily"
  - "Alerting on every CVE equally regardless of exploitability or asset exposure"
  - "Catch-all exception handlers that silently swallow errors on security-critical operations"
  - "No lock file committed to repository allowing dependency version drift"
  - "Fixing individual SQL injection instances instead of adopting parameterized queries everywhere"

examples:
  fail_secure: |
    # Bad: fail-open (grants access on error)
    try:
        user = authenticate(token)
    except AuthError:
        user = AnonymousUser(access='full')  # DANGEROUS

    # Good: fail-closed (denies access on error)
    try:
        user = authenticate(token)
    except AuthError:
        raise AccessDenied("Authentication failed")

  risk_prioritization: |
    Is it actively exploited (EPSS > 0.5)?
      YES -> CRITICAL: Immediate action
      NO  -> Check CVSS:
        CVSS >= 9.0     -> HIGH
        CVSS 7.0-8.9    -> Consider asset value and exposure
        CVSS < 7.0      -> Schedule for later sprint

  supply_chain_checklist: |
    Dependencies:
    [ ] Lock files committed and verified
    [ ] New packages audited before adding
    [ ] Versions pinned, not using ranges
    [ ] Private registry for critical internal packages
    Build Pipeline:
    [ ] CI/CD config change requires review
    [ ] Artifacts signed and verified
    [ ] Build environment is immutable

context: |
  The OWASP Top 10:2025 introduces two new categories: A03 Software Supply Chain
  (dependency attacks, CI/CD compromise, typosquatting) and A10 Exceptional
  Conditions (fail-open states, race conditions, resource exhaustion). Supply
  chain attacks are the fastest-growing threat vector. Vulnerability prioritization
  must combine CVSS severity with EPSS exploitability probability and business
  asset value. Scanning must be continuous, not point-in-time. Zero Trust
  architecture assumes breach and verifies at every boundary.

related:
  - owasp-api-security
  - web-application-security
  - secrets-management-patterns

tags:
  - security
  - vulnerability
  - owasp-2025
  - supply-chain
  - zero-trust
  - cvss
  - scanning
  - fail-secure
